<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script src="js/libs/jquery-1.8.0/jquery.min.js"></script>
        <script src="js/lw_mesh.js"></script>
        <script src="js/lw_area.js"></script>
        <script src="js/lw_army.js"></script>
        <script src="js/lw_config.js"></script>
        <script src="js/lw_game.js"></script>
        <script>
            /*function ImageLoader(images, onLoad) {
                this.notLoaded = images.length;
                this.onLoad = onLoad;
                if (images.length === 0) {
                    onLoad();
                }
                
                this.imageOnLoad = function() {
                    --this.notLoaded;
                    if (this.notLoaded === 0) {
                        this.onLoad();
                    }
                };
                
                this.images = Array();
                for (src in images) {
                    var image = new Image();
                    images.push(image);
                    image.onload = this.imageOnLoad;
                    image.src = src;
                }
            }*/
            var canvas;
            var ctx;
            function init() {
                canvas = document.querySelector("#canvas");
                ctx = canvas.getContext("2d");
                var img = document.querySelector("#img");
                game_test(img, ctx);
                var img2 = document.querySelector("#img2");
                game_test(img2, ctx);
                var img3 = document.querySelector("#img3");
                game_test(img3, ctx);
                var img4 = document.querySelector("#img4");
                game_test(img4, ctx);
            }
            
            function changeImage(id) {
                var img = document.querySelector(id);
                game_test(img, ctx);
            }
        
            function drawFighter(fighter, ctx, scale, team) {
                ctx.save();
                ctx.fillStyle = 'hsl(' + (team * 50) + ', 100%, 50%)';
//                ctx.strokeRect(fighter.x * scale, fighter.y * scale, scale, scale);
                ctx.fillRect(fighter.x * scale, fighter.y * scale, scale, scale);
                ctx.restore();
            }
    
            function game_test(img, ctx) {
                var game = initGame(img, ctx);
                var x = 0;
                var y = 0;
                var scale = 5;
                game.map.draw(ctx ,x, y, scale);
                drawMesh(game.mesh, ctx, x, y, scale);
                
                for (var i = 0; i < game.army.fighters.length; ++i) {
                    var fighter = game.army.fighters[i];
                    drawFighter(fighter, ctx, scale, fighter.team);
                    
                }
            }
    
            $(window).load(init);
        </script>
    </head>
    <body>
        <canvas width="640" height="640" id="canvas"></canvas>
        <img src="img/map.png" id="img" onclick="changeImage('#img');"/>
        <img src="img/map2.png" id="img2" onclick="changeImage('#img2');"/>
        <img src="img/map3.png" id="img3" onclick="changeImage('#img3');"/>
        <img src="img/map4.png" id="img4" onclick="changeImage('#img4');"/>
    </body>
</html>
